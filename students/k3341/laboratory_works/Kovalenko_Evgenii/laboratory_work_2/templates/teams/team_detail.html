{% extends 'base.html' %}

{% block title %}{{ team.name }} - Racing Championship{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-4">
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–∞–Ω–¥–µ -->
        <div class="card mb-4">
            <div class="card-body text-center">
                {% if team.logo %}
                <img src="{{ team.logo.url }}" alt="{{ team.name }}" class="img-fluid rounded mb-3" style="max-width: 200px;">
                {% else %}
                <div class="bg-secondary rounded-circle d-inline-flex align-items-center justify-content-center mb-3" style="width: 150px; height: 150px;">
                    <span class="text-white fw-bold display-6">{{ team.name|first }}</span>
                </div>
                {% endif %}

                <h2 class="card-title">{{ team.name }}</h2>
                <p class="card-text text-muted">
                    <strong>üìç –°—Ç—Ä–∞–Ω–∞:</strong> {{ team.country }}<br>
                    <strong>üìÖ –û—Å–Ω–æ–≤–∞–Ω–∞:</strong> {{ team.founded_date }}<br>
                    <strong>üë• –ì–æ–Ω—â–∏–∫–æ–≤:</strong> {{ racers.count }}<br>
                    <strong>üèéÔ∏è –ê–≤—Ç–æ–º–æ–±–∏–ª–µ–π:</strong> {{ cars.count }}
                </p>

                {% if team.description %}
                <div class="mt-3">
                    <h5>–û –∫–æ–º–∞–Ω–¥–µ</h5>
                    <p class="card-text">{{ team.description|linebreaks }}</p>
                </div>
                {% endif %}

                <div class="mt-4">
                    <a href="{% url 'team_list' %}" class="btn btn-outline-primary">–ù–∞–∑–∞–¥ –∫ –∫–æ–º–∞–Ω–¥–∞–º</a>
                    {% if user.is_staff %}
                    <a href="{% url 'admin:racing_app_team_change' team.id %}" class="btn btn-outline-secondary" target="_blank">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã -->
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã</h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-6">
                        <div class="border rounded p-3">
                            <h4 class="text-primary">{{ total_wins }}</h4>
                            <p class="mb-0">–ü–æ–±–µ–¥</p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="border rounded p-3">
                            <h4 class="text-success">{{ total_participations }}</h4>
                            <p class="mb-0">–£—á–∞—Å—Ç–∏–π</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-lg-8">
        <!-- –ì–æ–Ω—â–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">–ì–æ–Ω—â–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã</h5>
            </div>
            <div class="card-body">
                {% if racers %}
                <div class="row">
                    {% for racer in racers %}
                    <div class="col-md-6 mb-3">
                        <div class="d-flex align-items-center p-3 border rounded">
                            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center me-3"
                                 style="width: 50px; height: 50px;">
                                <span class="text-white fw-bold">
                                    {{ racer.user.first_name|first }}{{ racer.user.last_name|first }}
                                </span>
                            </div>
                            <div>
                                <h6 class="mb-1">{{ racer.user.get_full_name }}</h6>
                                <p class="mb-0 text-muted">
                                    <span class="badge bg-{% if racer.racer_class == 'Pro' %}danger{% elif racer.racer_class == 'Semi-pro' %}warning{% else %}secondary{% endif %}">
                                        {{ racer.get_racer_class_display }}
                                    </span>
                                    <span class="badge bg-success ms-1">{{ racer.wins_count }} –ø–æ–±–µ–¥</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center">–í –∫–æ–º–∞–Ω–¥–µ –ø–æ–∫–∞ –Ω–µ—Ç –≥–æ–Ω—â–∏–∫–æ–≤</p>
                {% endif %}
            </div>
        </div>

        <!-- –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã -->
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã</h5>
            </div>
            <div class="card-body">
                {% if cars %}
                <div class="row">
                    {% for car in cars %}
                    <div class="col-md-6 mb-4">
                        <div class="card h-100">
                            {% if car.image %}
                            <img src="{{ car.image.url }}" class="card-img-top" alt="{{ car.model }}" style="height: 200px; object-fit: cover;">
                            {% else %}
                            <div class="bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
                                <span class="text-muted">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                            </div>
                            {% endif %}
                            <div class="card-body">
                                <h6 class="card-title">{{ car.model }}</h6>
                                <p class="card-text small">
                                    <strong>–ö–ª–∞—Å—Å:</strong> {{ car.get_car_class_display }}<br>
                                    <strong>–î–≤–∏–≥–∞—Ç–µ–ª—å:</strong> {{ car.engine }}<br>
                                    <strong>–ú–æ—â–Ω–æ—Å—Ç—å:</strong> {{ car.horsepower }} –ª.—Å.
                                </p>
                                {% if car.description %}
                                <p class="card-text small">{{ car.description|truncatewords:20 }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center">–£ –∫–æ–º–∞–Ω–¥—ã –ø–æ–∫–∞ –Ω–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</p>
                {% endif %}
            </div>
        </div>

        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–Ω–∫–∏ –∫–æ–º–∞–Ω–¥—ã -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="card-title mb-0">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–Ω–∫–∏</h5>
            </div>
            <div class="card-body">
                {% if recent_races %}
                <div class="list-group list-group-flush">
                    {% for race in recent_races %}
                    <a href="{% url 'race_detail' race.id %}" class="list-group-item list-group-item-action">
                        <div class="d-flex w-100 justify-content-between">
                            <h6 class="mb-1">{{ race.name }}</h6>
                            <small>{{ race.start_date|date:"d.m.Y" }}</small>
                        </div>
                        <p class="mb-1 text-muted">{{ race.location }}</p>
                        <small class="text-muted">{{ race.get_race_type_display }}</small>
                    </a>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted text-center">–ö–æ–º–∞–Ω–¥–∞ –µ—â–µ –Ω–µ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª–∞ –≤ –≥–æ–Ω–∫–∞—Ö</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}